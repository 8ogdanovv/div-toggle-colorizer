<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Div Toggle Colorizer</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Victor+Mono:ital,wght@1,700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Victor Mono', monospace;
        }
        div {
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 50px;
            cursor: pointer;
            text-shadow: 0 0 5px black;
            letter-spacing: 0.25ch;
        }
    </style>
</head>
<body>
    <script>
        // Initialize an array to keep track of div positions
        const divPositions = [];

        // Function to toggle the position of a div
        function togglePosition(event) {
            const div = event.target;
            const clicked = parseInt(div.getAttribute('data-clicked'));
            const clone = div.cloneNode(true); // Create a deep copy
            clone.setAttribute('data-clicked', `${clicked + 1}`);

            if (clicked % 2 !== 0) {
                // Even click, move its copy to initial index
                const initialIndex = parseInt(clone.textContent.split('#')[1]);
                // Find target element by index as divs are stored in arr from 0
                const targetDiv = divPositions[initialIndex];

                // Inserting cloned element to initial position
                targetDiv.parentNode.insertBefore(clone, targetDiv);

            } else {
                // Odd click, create copy and move to top
                const firstDiv = document.body.firstChild;
                // Inserting clone before first dit - to the top
                document.body.insertBefore(clone, firstDiv);
            }

            // Attach the click event listener to the cloned element
            clone.onclick = togglePosition;

            // Removing copying source element
            div.parentNode.removeChild(div);

            console.log(divPositions);
        }
        // Function to colorize the divs with good contrast
        function colorizeDivs() {
            const divs = document.querySelectorAll('div.generated');
            const hueStep = 360 / divs.length;

            for (let i = 0; i < divs.length; i++) {
                const hue = i * hueStep;
                const bgColor = `hsl(${hue}, 100%, 50%)`;
                const shadowColor = `hsl(${(hue + 180) % 360}, 100%, 50%)`;
                divs[i].style.backgroundColor = bgColor;
                divs[i].style.color = `${shadowColor}`;

                // Populate the divPositions array initially
                divPositions.push(divs[i]);
            }
        }

        // Prepend the number with leading zeros
        function pad(num, size) {
            num = num.toString();
            while (num.length < size) num = "0" + num;
            return num;
        }

        // Generate and attach 100 divs to the body
        for (let i = 1; i <= 100; i++) {
            const div = document.createElement('div');
            div.classList.add('generated');
            div.textContent = `div#${pad(i, 3)}`;
            div.setAttribute('data-clicked', '0'); // Initially set to 0
            document.body.appendChild(div);

            // Attach the click event listener to each div
            div.onclick = togglePosition;
        }

        // Colorize the divs once they are generated
        colorizeDivs();
    </script>
</body>
</html>
